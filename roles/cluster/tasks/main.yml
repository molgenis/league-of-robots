---
- name: Set /etc/hosts
  template:
    src: templates/hosts
    dest: /etc/hosts
    mode: 0644
    owner: root
    group: root
    backup: yes
  become: true

- name: Set hostname to inventory_hostname
  hostname:
    name: '{{ inventory_hostname }}.hpc.local'
- name: set hostname in /etc/hosts
  lineinfile:
    dest: /etc/hosts
    regexp: '^127\.0\.0\.1[ \t]+localhost'
    line: '127.0.0.1 localhost {{ inventory_hostname }}'
    state: present

- name: set selinux in permissive mode
  selinux:
    policy: targeted
    state: permissive

- name: install the slurm client
  yum:
    name: slurm
    state: latest
    update_cache: yes

- name: set the slurm config file
  copy:
    src: roles/slurm/files/slurm.conf
    dest: /etc/slurm.conf
    mode: 0644
